{"mappings":"+eACA,IAAAA,EAAAC,EAAA,S,0BASA,MAIMC,EAAWC,SAASC,eAAe,sBAEzC,IAAIC,EAAQF,SAASG,cAAc,gBAMnCJ,EAASK,iBAAiB,SAASC,IACjC,MAAMC,EAAU,IAAI,EAAAT,EAAAU,SAAQC,EAAAC,MAAMC,KAAKX,GACvC,GAA6B,QAAzBM,EAAMM,OAAOC,QAEf,YADAN,EAAQO,OAGV,MAEMC,EAFWT,EAAMM,OAAOI,WACLA,WACFC,QAAQC,KAE/B,IAAIC,EAAelB,SAASG,cAAc,eAAeW,OACzDK,QAAQC,IAAIF,GAwFdG,eAA4BP,EAAQQ,GAClC,MAAMC,QAAiBC,MACrB,sCAAsCV,aAAkBQ,KAE1D,IAAKC,EAASE,GACZ,MAAM,IAAIC,MAAMH,EAASI,YAG3B,aAD0BJ,EAASK,M,CA7FnCC,CAAaf,EAzBC,oCA0BXgB,MAAKC,IACJZ,QAAQC,IAAIW,GACZ,IAAIC,EAAiB,GACrB,MAAMC,EAAaF,EAAYE,WAG/BD,EAF0BD,EAAYG,OACDC,KAAIC,GAAYA,EAASC,OAClCC,KAAK,MACjCnB,QAAQC,IAAIa,GACZ/B,EAAMqC,UAAY,GAClB,IAAIC,EAAS,6OAMPT,EAAYU,aAAeV,EAAYU,yWAUPV,EAAYW,aAAaC,QACrD,gEAEkCZ,EAAYa,kOAKVX,EAAWU,QACjD,mMAMAZ,EAAYc,yMAK2Bb,2HAKpBD,EAAYe,4WAYvC5C,EAAMqC,WAAaC,EA/EvBtC,EAAM6C,UAAUC,OAAO,aAkFnB1C,EAAQO,QAER,EAAAoC,EAAAC,cAAanB,IAEb,EAAAkB,EAAAE,YAAWpB,GAEW/B,SAASG,cAAc,sBAE/BC,iBAAiB,SAAS,KACtCF,EAAM6C,UAAUK,IAAI,YAAY,IAElCpD,SAASI,iBAAiB,WAAWiD,IACrB,WAAVA,EAAEC,KACJpD,EAAM6C,UAAUK,IAAI,YAAY,GAElC,IAEHG,OAAMC,GAASrC,QAAQC,IAAIoC,IAAO","sources":["src/js/modal-library.js"],"sourcesContent":["//import { API_KEY, fetchDetails } from './fetch-to-main';\nimport { Spinner } from 'spin.js';\nimport { opts } from './asynchronic-loader-opts';\nimport {\n  queueArray,\n  watchedArray,\n  addToWatched,\n  addToQueue,\n} from './add-to-queue-watched';\n\nconst API_KEY = `209b988e1e5a3c54f84bfbe290fdf3e2`;\n\n//modal//\n\nconst getMovie = document.getElementById('movie-list-library');\n\nlet modal = document.querySelector('[data-modal]');\n\nfunction toggleModal() {\n  modal.classList.toggle('is-hidden');\n}\n\ngetMovie.addEventListener('click', event => {\n  const spinner = new Spinner(opts).spin(getMovie);\n  if (event.target.tagName !== 'IMG') {\n    spinner.stop();\n    return;\n  }\n  const divOfImg = event.target.parentNode;\n  const liOfImg = divOfImg.parentNode;\n  const filmId = liOfImg.dataset.film;\n\n  let openModalBtn = document.querySelector(`[data-film=\"${filmId}\"]`);\n  console.log(openModalBtn);\n\n  fetchDetails(filmId, API_KEY)\n    .then(filmDetails => {\n      console.log(filmDetails);\n      let filmCategories = '';\n      const popularity = filmDetails.popularity;\n      const tableOfCategories = filmDetails.genres;\n      const categories = tableOfCategories.map(category => category.name);\n      filmCategories = categories.join(', ');\n      console.log(popularity);\n      modal.innerHTML = '';\n      let markup = `\n    <div class=\"modal\">\n      <button type=\"button\" class=\"modal__close-btn\" data-modal-close>&#10005</button>\n      <div class=\"modal__img\">\n        <img class=\"modal__img-picture\"\n          src=https://image.tmdb.org/t/p/w500/${\n            filmDetails.poster_path || filmDetails.poster_path\n          }\n          alt=\"obraz\"/>\n      </div>\n      <div class=\"modal__content\">\n        <h2 class=\"modal__head\"></h2>\n        <ul class=\"modal__list\">\n          <li class=\"modal__item\">\n            <span class=\"modal__votes modal__parameters\">Vote / Votes</span>\n            <div class=\"modal_wrapper\">\n              <span class=\"modal__rating\">${filmDetails.vote_average.toFixed(\n                1\n              )}</span> /\n              <span class=\"modal__votes-number\">${filmDetails.vote_count}</span>\n            </div>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__popularity modal__parameters\">Popularity</span>\n            <span class=\"modal__popularity-total\">${popularity.toFixed(\n              1\n            )}</span>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__title modal__parameters\">Original Title</span>\n            <span class=\"modal__title-original\">${\n              filmDetails.original_title\n            }</span>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__genre modal__parameters\">Genre</span>\n            <span class=\"modal__genre-description\">${filmCategories}</span>\n          </li>\n        </ul>\n  \n        <p class=\"modal__about\">About</p>\n        <p class=\"modal__text\">${filmDetails.overview}</p>\n  \n        <div class=\"modal__button-container\">\n          <button class=\"modal__button-watched modal__buttons\" type=\"button\">\n            ADD TO WATCHED\n          </button>\n          <button class=\"modal__button-queue modal__buttons\" type=\"button\">\n            ADD TO QUEUE\n          </button>\n        </div>\n        </div>\n      </div>`;\n      modal.innerHTML += markup;\n      toggleModal();\n\n      spinner.stop();\n\n      addToWatched(filmDetails);\n\n      addToQueue(filmDetails);\n\n      const closeModalBtn = document.querySelector('[data-modal-close]');\n\n      closeModalBtn.addEventListener('click', () => {\n        modal.classList.add('is-hidden');\n      });\n      document.addEventListener('keydown', e => {\n        if (e.key === 'Escape') {\n          modal.classList.add('is-hidden');\n        }\n      });\n    })\n    .catch(error => console.log(error));\n});\n\nasync function fetchDetails(filmId, API_KEY) {\n  const response = await fetch(\n    `https://api.themoviedb.org/3/movie/${filmId}?api_key=${API_KEY}`\n  );\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  }\n  const filmDetails = await response.json();\n  return filmDetails;\n}\n"],"names":["$dCvm9","parcelRequire","$2631b5b1e00936b8$var$getMovie","document","getElementById","$2631b5b1e00936b8$var$modal","querySelector","addEventListener","event","spinner","Spinner","$jdSc9","opts","spin","target","tagName","stop","filmId","parentNode","dataset","film","openModalBtn","console","log","async","API_KEY1","response","fetch","ok","Error","statusText","json","$2631b5b1e00936b8$var$fetchDetails","then","filmDetails","filmCategories","popularity","genres","map","category","name","join","innerHTML","markup","poster_path","vote_average","toFixed","vote_count","original_title","overview","classList","toggle","$gFm7s","addToWatched","addToQueue","add","e","key","catch","error"],"version":3,"file":"library.759a6551.js.map"}