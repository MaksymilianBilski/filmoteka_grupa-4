{"mappings":"4iBACA,IAAAA,EAAAC,EAAA,S,oDAaMC,EAAWC,SAASC,eAAe,sBAErCC,EAAQF,SAASG,cAAc,gB,SAyGpBC,I,OAAAA,EAAfC,EAAAR,EAAA,CAAAQ,EAAAC,GAAAC,MAAA,SAAAC,EAA4BC,EAAQC,G,IAC5BC,EAMAC,E,kFANiBC,MACrB,sCAAwDC,OAAlBL,EAAO,aAAmBK,OAARJ,I,WADpDC,EAAQI,EAAAC,MAGAC,GAAE,C,eACd,MAAM,IAAIC,MAAMP,EAASQ,Y,uBAEDR,EAASS,O,cAA7BR,EAAWG,EAAAC,K,kBACVJ,G,4CARkBS,MAAAC,KAAAC,U,CAnG3BxB,EAASyB,iBAAiB,SAAS,SAAAC,GACjC,IAAMC,EAAU,IAAI,EAAAC,EAAAC,SAAQC,EAAAC,MAAMC,KAAKhC,GACvC,GAA6B,QAAzB0B,EAAMO,OAAOC,QAAjB,CAIA,IAEMxB,EAFWgB,EAAMO,OAAOE,WACLA,WACFC,QAAQC,KAE3BC,EAAerC,SAASG,cAAc,eAAsBW,OAAPL,EAAO,OAChE6B,QAAQC,IAAIF,G,SAwFc5B,EAAQC,G,OAArBN,EAAYiB,MAAAC,KAAAC,U,CAtFzBiB,CAAa/B,EAzBE,oCA0BZgC,MAAK,SAAA7B,GACJ0B,QAAQC,IAAI3B,GACZ,IAAI8B,EACEC,EAAa/B,EAAY+B,WAG/BD,EAF0B9B,EAAYgC,OACDC,KAAI,SAAAC,G,OAAYA,EAASC,I,IAClCC,KAAK,MACjCV,QAAQC,IAAII,GACZzC,EAAM+C,UAAY,GAClB,IAAIC,EAAS,6OAgByBpC,OAVhCF,EAAYuC,aAAevC,EAAYuC,YACxC,+VAYuCrC,OAHNF,EAAYwC,aAAaC,QACrD,GACA,+DAMoCvC,OALFF,EAAY0C,WAAW,yNAY3DxC,OAPsC6B,EAAWU,QACjD,GACA,kMAUuCvC,OALvCF,EAAY2C,eACb,4LASoBzC,OALoB4B,EAAe,2HAKd5B,OAArBF,EAAY4C,SAAS,qWAYhDtD,EAAM+C,WAAaC,EA/EvBhD,EAAMuD,UAAUC,OAAO,aAkFnBhC,EAAQiC,QAER,EAAAC,EAAAC,cAAajD,IAEb,EAAAgD,EAAAE,YAAWlD,GAEWZ,SAASG,cAAc,sBAE/BqB,iBAAiB,SAAS,WACtCtB,EAAMuD,UAAUM,IAAI,Y,IAEtB/D,SAASwB,iBAAiB,WAAW,SAAAwC,GACrB,WAAVA,EAAEC,KACJ/D,EAAMuD,UAAUM,IAAI,Y,OAIzBG,OAAM,SAAAC,G,OAAS7B,QAAQC,IAAI4B,E,SA7F5BzC,EAAQiC,M","sources":["src/js/modal-library.js"],"sourcesContent":["//import { API_KEY, fetchDetails } from './fetch-to-main';\nimport { Spinner } from 'spin.js';\nimport { opts } from './asynchronic-loader-opts';\nimport {\n  queueArray,\n  watchedArray,\n  addToWatched,\n  addToQueue,\n} from './add-to-queue-watched';\n\nconst API_KEY = `209b988e1e5a3c54f84bfbe290fdf3e2`;\n\n//modal//\n\nconst getMovie = document.getElementById('movie-list-library');\n\nlet modal = document.querySelector('[data-modal]');\n\nfunction toggleModal() {\n  modal.classList.toggle('is-hidden');\n}\n\ngetMovie.addEventListener('click', event => {\n  const spinner = new Spinner(opts).spin(getMovie);\n  if (event.target.tagName !== 'IMG') {\n    spinner.stop();\n    return;\n  }\n  const divOfImg = event.target.parentNode;\n  const liOfImg = divOfImg.parentNode;\n  const filmId = liOfImg.dataset.film;\n\n  let openModalBtn = document.querySelector(`[data-film=\"${filmId}\"]`);\n  console.log(openModalBtn);\n\n  fetchDetails(filmId, API_KEY)\n    .then(filmDetails => {\n      console.log(filmDetails);\n      let filmCategories = '';\n      const popularity = filmDetails.popularity;\n      const tableOfCategories = filmDetails.genres;\n      const categories = tableOfCategories.map(category => category.name);\n      filmCategories = categories.join(', ');\n      console.log(popularity);\n      modal.innerHTML = '';\n      let markup = `\n    <div class=\"modal\">\n      <button type=\"button\" class=\"modal__close-btn\" data-modal-close>&#10005</button>\n      <div class=\"modal__img\">\n        <img class=\"modal__img-picture\"\n          src=https://image.tmdb.org/t/p/w500/${\n            filmDetails.poster_path || filmDetails.poster_path\n          }\n          alt=\"obraz\"/>\n      </div>\n      <div class=\"modal__content\">\n        <h2 class=\"modal__head\"></h2>\n        <ul class=\"modal__list\">\n          <li class=\"modal__item\">\n            <span class=\"modal__votes modal__parameters\">Vote / Votes</span>\n            <div class=\"modal_wrapper\">\n              <span class=\"modal__rating\">${filmDetails.vote_average.toFixed(\n                1\n              )}</span> /\n              <span class=\"modal__votes-number\">${filmDetails.vote_count}</span>\n            </div>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__popularity modal__parameters\">Popularity</span>\n            <span class=\"modal__popularity-total\">${popularity.toFixed(\n              1\n            )}</span>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__title modal__parameters\">Original Title</span>\n            <span class=\"modal__title-original\">${\n              filmDetails.original_title\n            }</span>\n          </li>\n          <li class=\"modal__item\">\n            <span class=\"modal__genre modal__parameters\">Genre</span>\n            <span class=\"modal__genre-description\">${filmCategories}</span>\n          </li>\n        </ul>\n  \n        <p class=\"modal__about\">About</p>\n        <p class=\"modal__text\">${filmDetails.overview}</p>\n  \n        <div class=\"modal__button-container\">\n          <button class=\"modal__button-watched modal__buttons\" type=\"button\">\n            ADD TO WATCHED\n          </button>\n          <button class=\"modal__button-queue modal__buttons\" type=\"button\">\n            ADD TO QUEUE\n          </button>\n        </div>\n        </div>\n      </div>`;\n      modal.innerHTML += markup;\n      toggleModal();\n\n      spinner.stop();\n\n      addToWatched(filmDetails);\n\n      addToQueue(filmDetails);\n\n      const closeModalBtn = document.querySelector('[data-modal-close]');\n\n      closeModalBtn.addEventListener('click', () => {\n        modal.classList.add('is-hidden');\n      });\n      document.addEventListener('keydown', e => {\n        if (e.key === 'Escape') {\n          modal.classList.add('is-hidden');\n        }\n      });\n    })\n    .catch(error => console.log(error));\n});\n\nasync function fetchDetails(filmId, API_KEY) {\n  const response = await fetch(\n    `https://api.themoviedb.org/3/movie/${filmId}?api_key=${API_KEY}`\n  );\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  }\n  const filmDetails = await response.json();\n  return filmDetails;\n}\n"],"names":["$eZ7d6","parcelRequire","$5274909fd9dfb2b1$var$getMovie","document","getElementById","$5274909fd9dfb2b1$var$modal","querySelector","$5274909fd9dfb2b1$var$_fetchDetails","$parcel$interopDefault","$2TvXO","mark","_callee","filmId","API_KEY1","response","filmDetails","fetch","concat","_ctx","sent","ok","Error","statusText","json","apply","this","arguments","addEventListener","event","spinner","$b62ED","Spinner","$85mSR","opts","spin","target","tagName","parentNode","dataset","film","openModalBtn","console","log","$5274909fd9dfb2b1$var$fetchDetails","then","filmCategories","popularity","genres","map","category","name","join","innerHTML","markup","poster_path","vote_average","toFixed","vote_count","original_title","overview","classList","toggle","stop","$ipPc5","addToWatched","addToQueue","add","e","key","catch","error"],"version":3,"file":"library.f3fa79bd.js.map"}